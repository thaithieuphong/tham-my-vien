<link rel="stylesheet" href="/css/root.css">
<link rel="stylesheet" href="/css/assistant.css">
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasWithBackdrop"
    aria-labelledby="offcanvasWithBackdropLabel">
    <div class="offcanvas-header bg-blue border-bottom">
        <h5 class="offcanvas-title text-white" id="offcanvasWithBackdropLabel">BẢNG ĐIỀU KHIỂN</h5>
        <button type="button" class="btn-close text-reset btn-light" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body container-sidebar bg-blue">
        <div class="sidebar-item">
            <a href="/business/employ/service-note" class="sidebar-item-title pl-3">
                <i class="ti-receipt mr-3"></i>Dịch vụ
            </a>
        </div>
		<div class="sidebar-item">
            <a href="/business/employ/customers" class="sidebar-item-title pl-3">
                <i class="ti-user mr-3"></i>Khách hàng
            </a>
        </div>
    </div>
	<div class="offcanvas-footer bg-blue border-top">
        <div class="sidebar-item">
            <a href="/business/employ/profile" class="sidebar-item-title pl-3">
                <i class="ti-user mr-3"></i>Thông tin người dùng
            </a>
        </div>
		<div class="sidebar-item">
			<form method="POST" action="/logout">
				<button href="/logout" class="btn btn-danger logout-btn" type="submit">Đăng xuất</>
			</form>
		</div>
    </div>
</div>
<div class="sticky-top">
	<div class="redirect-bar bg-blue d-flex justify-content-between border-bottom">
		<a class="ml-3 text-light" type="button" onclick="history.back()"><i class="ti-arrow-left"></i> Quay lại</a>
	</div>
	<ul class="nav nav-pills ml-0 bg-blue d-flex justify-content-between justify-content-sm-start" id="pills-tab" role="tablist">
		<li class="nav-item" role="presentation">
			<button class="nav-link active text-light" id="pills-system-customer-tab" data-bs-toggle="pill"
				data-bs-target="#pills-system-customer" type="button" role="tab" aria-controls="pills-home"
				aria-selected="true">Thông tin khách hàng</button>
		</li>
		<li class="nav-item" role="presentation">
			<button class="nav-link text-light" id="pills-user-customer-tab" data-bs-toggle="pill"
				data-bs-target="#pills-user-customer" type="button" role="tab" aria-controls="pills-profile"
				aria-selected="false">Dịch vụ đã sử dụng</button>
		</li>
	</ul>
</div>
<div class="container-fluid">
	<div class="tab-content" id="pills-tabContent">
		<div class="tab-pane fade show active" id="pills-system-customer" role="tabpanel"
			aria-labelledby="pills-home-tab">
			<div class="row">
				<div class="col-xl-4 col-lg-4 col-md-4 mt-3">
					{{#if customer.image}}
					<div class="mt-2 text-center">
						<img src="{{customer.image.url}}" id="add-avt"
							class="rounded add-avata" alt="...">
					</div>
					{{else}}
					<div class="col-md-6 mt-2 text-center">
						<img src="/img/user-icon.png" id="add-avt" class="rounded  add-avata" alt="...">
					</div>
					{{/if}}
					<div class="d-flex justify-content-between mt-3 text-light">
						<label for="status">
							<strong>Họ tên:</strong>&nbsp;
						</label>
						<label class="text-uppercase text-danger">{{customer.firstName}} {{customer.lastName}}</label>
					</div>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Ngày sinh:</strong>&nbsp;
						</label>
						<label id="create-service-note-birth" name="birth">{{formatBirth customer.birth}}</label>
					</div>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Giới tính:</strong>&nbsp;
						</label>
						<label id="create-service-note-gender" name="gender">{{customer.gender}}</label>
					</div>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Email:</strong>&nbsp;
						</label>
						<label id="create-service-note-email" name="email">{{customer.email}}</label>
					</div>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Số điện thoại:</strong>&nbsp;
						</label>
						<label id="create-service-note-phone" name="phone" readonly>{{customer.phone}}</label>
					</div>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Địa chỉ:</strong>&nbsp;
						</label>
					</div>
					<p id="create-service-note-address" name="address" class="text-wrap text-justify text-light">{{customer.address}}</p>
					<div class="d-flex justify-content-between text-light">
						<label for="status">
							<strong>Mô tả:</strong>&nbsp;
						</label>
					</div>
					<textarea id="detail-description" class="form-control bg-light" rows="8" readonly>{{customer.description}}</textarea>
				</div>
				<div class="col-xl-8 col-lg-8 col-md-8">
					<ul class="list-group border comment-ctv-page mt-3">
						{{#each customer.comments}}
						<li id="width-li" class="list-group mt-2 bg-white ml-2 mr-2">
							<p class="message-content">{{this.comment}}</p>
							<small>
								<p id="createdAt" class="none-mb comment-createdAt text-nowrap text-right"><em>{{formatDate
									this.createdAt}}</em></p>
							</small>
						</li>
						<hr>
						{{!-- <hr class="mt-3"> --}}
						{{/each}}
					</ul>
					<form method="POST" action="/business/employ/customers/{{customer._id}}/comment?_method=PATCH">
						<div class="input-group mt-3 mb-3">
							<textarea type="text" class="form-control form-control-sm" id="comments" name="comments"
							placeholder="Thêm hoạt động..." required></textarea>
								<button type="submit" class="btn btn-primary btn-sm">Lưu</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<div class="tab-pane fade" id="pills-user-customer" role="tabpanel" aria-labelledby="pills-profile-tab">
			<p class="none-mb text-light" value="" for="service-note-service"><strong>Dịch vụ:</strong></p>
			{{#each customer.serviceNoteID}}
			<p class="none-mb text-light" value="" for="service-note-service">{{this.service}} ({{this.status}})</p>
			<hr>
			{{else}}
			<p class="text-light">Chưa sử dụng dịch vụ nào</p>
			{{/each}}
		</div>
	</div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
	const textarea = document.querySelectorAll('.message-content');
	for (i = 0; i < textarea.length; i++) {
		let element = textarea[i];
		let textValue = element.innerHTML;
		let textSplit = textValue.split('\n');
		let cols = textValue.length;
		let rows = textSplit.length;
		let result = textSplit.join('<br>');
		element.innerHTML = result;
		let parent = element.clientWidth;
		let ex = parent - cols;
	}
})
</script>